(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6251:function(e,a,n){Promise.resolve().then(n.bind(n,2644))},2644:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return h}});var t=n(7437),s=n(2265);let r=(0,n(9066).eI)("https://cjbjxkdqttcrivhbayou.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNqYmp4a2RxdHRjcml2aGJheW91Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUxNDg5NDUsImV4cCI6MjA4MDcyNDk0NX0.HnpM5moOF-YOgnyvUlVFevzDQmgYOL5crC19KnBL7tA"),i=["\xa1Buen voto!","\xa1Elecci\xf3n s\xf3lida!","\xa1Gran docente!","\xa1Me gusta!","\xa1Bac\xe1n!"],c=["Sigues en racha","No pares","Ritmo ganador","Al toque","Con punche"],l=["mano","al toque","tranqui","ya pe","bac\xe1n"];function h(){let[e,a]=(0,s.useState)([]),[n,h]=(0,s.useState)([]),[o,d]=(0,s.useState)(0),[m,u]=(0,s.useState)(""),[g,j]=(0,s.useState)(!0),[x,f]=(0,s.useState)(null);function N(){let a=e.filter(e=>!e.eliminated);if(a.length<2){h([]);return}let n=Math.floor(Math.random()*a.length),t=Math.floor(Math.random()*a.length);for(;n===t;)t=Math.floor(Math.random()*a.length);h([a[n],a[t]])}async function p(e,n){let[t,s]=function(e,a){let n=1/(1+Math.pow(10,(a-e)/400));return[e+32*(1-n),a+32*(0-(1-n))]}(e.rating,n.rating),{error:h}=await r.from("teachers").update({rating:t,votes:e.votes+1}).eq("id",e.id),{error:m}=await r.from("teachers").update({rating:s}).eq("id",n.id);if(h||m){console.error("Error updating ratings:",{winnerError:h,loserError:m});return}a(a=>a.map(a=>a.id===e.id?{...a,rating:t,votes:a.votes+1}:a.id===n.id?{...a,rating:s}:a));let g=l[Math.floor(Math.random()*l.length)],j=o>2?c[Math.floor(Math.random()*c.length)]:i[Math.floor(Math.random()*i.length)];u("".concat(j,", ").concat(g)),d(o+1),setTimeout(()=>{u("")},2e3),N()}(0,s.useEffect)(()=>{(async()=>{j(!0),f(null);try{let{data:e,error:n}=await r.from("teachers").select("*");if(n)throw n;a(e||[])}catch(e){console.error("Error fetching teachers:",e),f("Could not fetch teachers. Please check the console and ensure your Supabase RLS is configured correctly.")}finally{j(!1)}})()},[]),(0,s.useEffect)(()=>{e.length>0&&N()},[e]);let v=[...e].sort((e,a)=>a.rating-e.rating);return g?(0,t.jsxs)("main",{className:"container",children:[(0,t.jsx)("h1",{children:"Battle Royale de Docentes"}),(0,t.jsx)("p",{children:"Loading teachers..."})]}):x?(0,t.jsxs)("main",{className:"container",children:[(0,t.jsx)("h1",{children:"Battle Royale de Docentes"}),(0,t.jsxs)("p",{style:{color:"red"},children:["Error: ",x]})]}):0!==e.length||g?n.length<2?(0,t.jsxs)("main",{className:"container",children:[(0,t.jsx)("h1",{children:"Battle Royale de Docentes"}),(0,t.jsx)("h2",{children:"Ranking de Docentes"}),(0,t.jsx)("div",{className:"ranking",children:v.map((e,a)=>(0,t.jsxs)("div",{className:"teacher-ranking",children:[(0,t.jsxs)("span",{className:"rank",children:["#",a+1]}),(0,t.jsx)("img",{src:e.image,alt:e.name,width:50,height:50}),(0,t.jsx)("span",{className:"name",children:e.name}),(0,t.jsx)("span",{className:"rating",children:Math.round(e.rating)})]},e.id))})]}):(0,t.jsxs)("main",{children:[m&&(0,t.jsx)("div",{className:"toast",children:m}),(0,t.jsxs)("div",{className:"battle-container",children:[(0,t.jsxs)("div",{className:"teacher",onClick:()=>p(n[0],n[1]),children:[(0,t.jsx)("img",{src:n[0].image,alt:n[0].name}),(0,t.jsx)("h3",{children:n[0].name})]}),(0,t.jsx)("div",{className:"vs",children:"VS"}),(0,t.jsxs)("div",{className:"teacher",onClick:()=>p(n[1],n[0]),children:[(0,t.jsx)("img",{src:n[1].image,alt:n[1].name}),(0,t.jsx)("h3",{children:n[1].name})]})]}),(0,t.jsxs)("div",{className:"ranking-container",children:[(0,t.jsx)("h2",{children:"Ranking"}),(0,t.jsx)("div",{className:"ranking",children:v.slice(0,10).map((e,a)=>(0,t.jsxs)("div",{className:"teacher-ranking",children:[(0,t.jsxs)("span",{className:"rank",children:["#",a+1]}),(0,t.jsx)("img",{src:e.image,alt:e.name,width:30,height:30}),(0,t.jsx)("span",{className:"name",children:e.name}),(0,t.jsx)("span",{className:"rating",children:Math.round(e.rating)})]},e.id))})]})]}):(0,t.jsxs)("main",{className:"container",children:[(0,t.jsx)("h1",{children:"Battle Royale de Docentes"}),(0,t.jsx)("p",{children:"No teachers found. The database might be empty or there was an issue fetching them."})]})}}},function(e){e.O(0,[66,971,117,744],function(){return e(e.s=6251)}),_N_E=e.O()}]);