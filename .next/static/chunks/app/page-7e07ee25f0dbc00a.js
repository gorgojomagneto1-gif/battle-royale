(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2931:function(e,a,n){Promise.resolve().then(n.bind(n,2644))},2644:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return h}});var t=n(7437),s=n(2265);let i=(0,n(9066).eI)("https://cjbjxkdqttcrivhbayou.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNqYmp4a2RxdHRjcml2aGJheW91Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUxNDg5NDUsImV4cCI6MjA4MDcyNDk0NX0.HnpM5moOF-YOgnyvUlVFevzDQmgYOL5crC19KnBL7tA"),r=["\xa1Buen voto!","\xa1Elecci\xf3n s\xf3lida!","\xa1Gran docente!","\xa1Me gusta!","\xa1Bac\xe1n!"],c=["Sigues en racha","No pares","Ritmo ganador","Al toque","Con punche"],l=["mano","al toque","tranqui","ya pe","bac\xe1n"];function h(){let[e,a]=(0,s.useState)([]),[n,h]=(0,s.useState)([]),[o,d]=(0,s.useState)(0),[m,g]=(0,s.useState)("");function u(){let a=e.filter(e=>!e.eliminated);if(a.length<2){h([]);return}let n=Math.floor(Math.random()*a.length),t=Math.floor(Math.random()*a.length);for(;n===t;)t=Math.floor(Math.random()*a.length);h([a[n],a[t]])}async function j(e,n){let[t,s]=function(e,a){let n=1/(1+Math.pow(10,(a-e)/400));return[e+32*(1-n),a+32*(0-(1-n))]}(e.rating,n.rating),{error:h}=await i.from("teachers").update({rating:t,votes:e.votes+1}).eq("id",e.id),{error:m}=await i.from("teachers").update({rating:s}).eq("id",n.id);if(h||m){console.error("Error updating ratings:",{winnerError:h,loserError:m});return}a(a=>a.map(a=>a.id===e.id?{...a,rating:t,votes:a.votes+1}:a.id===n.id?{...a,rating:s}:a));let j=l[Math.floor(Math.random()*l.length)],f=o>2?c[Math.floor(Math.random()*c.length)]:r[Math.floor(Math.random()*r.length)];g("".concat(f,", ").concat(j)),d(o+1),setTimeout(()=>{g("")},2e3),u()}(0,s.useEffect)(()=>{(async()=>{let{data:e,error:n}=await i.from("teachers").select("*");n?console.error("Error fetching teachers:",n):a(e)})()},[]),(0,s.useEffect)(()=>{e.length>0&&u()},[e]);let f=[...e].sort((e,a)=>a.rating-e.rating);return n.length<2?(0,t.jsxs)("main",{className:"container",children:[(0,t.jsx)("h1",{children:"Battle Royale de Docentes"}),(0,t.jsx)("h2",{children:"Ranking de Docentes"}),(0,t.jsx)("div",{className:"ranking",children:f.map((e,a)=>(0,t.jsxs)("div",{className:"teacher-ranking",children:[(0,t.jsxs)("span",{className:"rank",children:["#",a+1]}),(0,t.jsx)("img",{src:e.image,alt:e.name,width:50,height:50}),(0,t.jsx)("span",{className:"name",children:e.name}),(0,t.jsx)("span",{className:"rating",children:Math.round(e.rating)})]},e.id))})]}):(0,t.jsxs)("main",{children:[m&&(0,t.jsx)("div",{className:"toast",children:m}),(0,t.jsxs)("div",{className:"battle-container",children:[(0,t.jsxs)("div",{className:"teacher",onClick:()=>j(n[0],n[1]),children:[(0,t.jsx)("img",{src:n[0].image,alt:n[0].name}),(0,t.jsx)("h3",{children:n[0].name})]}),(0,t.jsx)("div",{className:"vs",children:"VS"}),(0,t.jsxs)("div",{className:"teacher",onClick:()=>j(n[1],n[0]),children:[(0,t.jsx)("img",{src:n[1].image,alt:n[1].name}),(0,t.jsx)("h3",{children:n[1].name})]})]}),(0,t.jsxs)("div",{className:"ranking-container",children:[(0,t.jsx)("h2",{children:"Ranking"}),(0,t.jsx)("div",{className:"ranking",children:f.slice(0,10).map((e,a)=>(0,t.jsxs)("div",{className:"teacher-ranking",children:[(0,t.jsxs)("span",{className:"rank",children:["#",a+1]}),(0,t.jsx)("img",{src:e.image,alt:e.name,width:30,height:30}),(0,t.jsx)("span",{className:"name",children:e.name}),(0,t.jsx)("span",{className:"rating",children:Math.round(e.rating)})]},e.id))})]})]})}}},function(e){e.O(0,[66,971,117,744],function(){return e(e.s=2931)}),_N_E=e.O()}]);